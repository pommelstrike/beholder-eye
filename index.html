document.addEventListener('DOMContentLoaded', initializeApp);

function initializeApp() {
  const dropZone = document.getElementById('dropZone');

  // Check if the drop zone exists
  if (!dropZone) {
    console.error("Drop zone element not found. Ensure the HTML element with ID 'dropZone' exists.");
    return;
  }

  // Add drag-and-drop event listeners
  dropZone.addEventListener('dragover', (e) => {
    e.preventDefault();
    dropZone.style.backgroundColor = '#2C2C2C'; // Highlight on drag
  });

  dropZone.addEventListener('dragleave', () => {
    dropZone.style.backgroundColor = '#1F1F1F'; // Revert on drag leave
  });

  dropZone.addEventListener('drop', (e) => {
    e.preventDefault();
    dropZone.style.backgroundColor = '#1F1F1F'; // Revert on drop

    const files = e.dataTransfer.files;
    if (files.length > 0) {
      handleFiles(files);
    } else {
      alert('No files detected. Please try again.');
    }
  });

  // Function to handle dropped files
  function handleFiles(files) {
    const messageArea = document.createElement('div');
    messageArea.id = 'fileMessage';
    messageArea.style.marginTop = '20px';
    messageArea.style.color = '#03DAC5';

    document.body.appendChild(messageArea);
    messageArea.innerHTML = '<strong>Processing files:</strong>';

    for (const file of files) {
      if (file.name.endsWith('.lsx')) {
        console.log(`Processing file: ${file.name}`);
        const fileMessage = document.createElement('p');
        fileMessage.textContent = `Processing file: ${file.name}`;
        messageArea.appendChild(fileMessage);
      } else {
        alert(`Unsupported file type: ${file.name}`);
      }
    }
  }
}
